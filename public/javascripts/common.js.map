{"version":3,"sources":["common.js"],"names":["$","createImgNode","element","src","img","document","createElement","onload","attr","addClass","getCondition","css","hide","show","fn","fullpage","reBuild","hideCondition","getCards","ajax","url","cardsrequestCount","cardsPagesCount","type","done","cards","assignId","posts","cardsArray","length","concat","cardsLoader","masonry","masonryConfig","isMasonryCreated","newCards","map","card","newCard","createCard","append","setAllowScrolling","clickHandler","console","log","id","this","index","currentCard","fullBlock","find","html","name","image","text","reduceText","string","visibleSymbols","substring","lastIndex","imgHeight","imgWidth","Image","width","naturalWidth","height","naturalHeight","dim","modifer","providerType","get","resizeHandler","window","itemSelector","columnWidth","percentPosition","bloggerConfig","dots","arrows","infinite","vertical","speed","slidesToShow","slidesToScroll","prevArrow","nextArrow","dotsClass","responsive","breakpoint","settings","dreamersConfig","centerMode","draggable","focusOnSelect","variableWidth","isOpen","each","on","toggleClass","fadeToggle","trigger","scrollOverflow","navigation","slick","click","e","ontouchstart","target","closest","removeClass"],"mappings":"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","file":"../sources/common.js","sourcesContent":["$(function() {\r\n    let isMasonryCreated = false;\r\n    let cardsLoader;\r\n    let cardsArray = [];\r\n    let masonryConfig = {\r\n        itemSelector: '.c-card',\r\n        columnWidth: '.c-card__sizer',\r\n        percentPosition: true\r\n    };\r\n    let bloggerConfig = {\r\n        dots: true,\r\n        arrows: true,\r\n        infinite: false,\r\n        vertical: false,\r\n        speed: 800,\r\n        slidesToShow: 4,\r\n        slidesToScroll: 4,\r\n        prevArrow: '<svg class=\"c-arrow c-arrow__prev\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#arrow-l\"></use></svg>',\r\n        nextArrow: '<svg class=\"c-arrow c-arrow__next\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#arrow-r\"></use></svg>',\r\n        dotsClass: 'slick-dots c-bloggers__dots',\r\n        responsive: [{\r\n                breakpoint: 992,\r\n                settings: {\r\n                    slidesToShow: 3,\r\n                    slidesToScroll: 3\r\n                }\r\n            },\r\n            {\r\n                breakpoint: 767,\r\n                settings: {\r\n                    slidesToShow: 2,\r\n                    slidesToScroll: 2\r\n                }\r\n            }, {\r\n                breakpoint: 480,\r\n                settings: {\r\n                    slidesToShow: 1,\r\n                    slidesToScroll: 1,\r\n                    arrows: false\r\n                }\r\n            }\r\n        ]\r\n    };\r\n    let dreamersConfig = {\r\n        dots: false,\r\n        centerMode: true,\r\n        arrows: true,\r\n        infinite: true,\r\n        draggable: true,\r\n        speed: 500,\r\n        slidesToShow: 5,\r\n        focusOnSelect: true,\r\n        variableWidth: true,\r\n        prevArrow: '<svg class=\"c-arrow c-arrow__prev\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#arrow-l\"></use></svg>',\r\n        nextArrow: '<svg class=\"c-arrow c-arrow__next\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#arrow-r\"></use></svg>',\r\n        responsive: [{\r\n                breakpoint: 992,\r\n                settings: {\r\n                    slidesToShow: 3\r\n                }\r\n            },\r\n            {\r\n                breakpoint: 767,\r\n                settings: {\r\n                    slidesToShow: 2\r\n                }\r\n            }, {\r\n                breakpoint: 480,\r\n                settings: {\r\n                    slidesToShow: 1,\r\n                    \r\n\r\n                }\r\n            }\r\n        ]\r\n    }\r\n    let cardsPagesCount = 1;\r\n    const visibleSymbols = 85;\r\n    const cardsrequestCount = 8;\r\n    let isOpen = false;\r\n\r\n    $('.lazy').each(function() {\r\n        let src = $(this).attr('data-lazy');\r\n        createImgNode($(this), src);\r\n    })\r\n\r\n    function createImgNode(element, src) {\r\n        var img = document.createElement(\"img\");\r\n        img.src = src;\r\n        img.onload = function() {\r\n            element.attr('style', 'background-image: url(' + src + ');');\r\n            element.addClass('visible');\r\n            $('.c-section__header').attr('style', 'bottom: 120px');\r\n        }\r\n\r\n    }\r\n\r\n    $('.js-menu-button, .c-menu-fixed .c-menu__item').on('click', function() {\r\n        $('html').toggleClass('t-open-menu');\r\n        $('.c-menu-fixed').fadeToggle(200, function() {\r\n            isOpen = !isOpen;\r\n            $('.c-menu-fixed').trigger('toggle', isOpen);\r\n        });\r\n    });\r\n\r\n    $('.c-section-container').fullpage({\r\n        scrollOverflow: true,\r\n        navigation: true\r\n    });\r\n\r\n    getCards();\r\n    $('.c-bloggers').slick(bloggerConfig);\r\n    $('#more-cards').click(getCards);\r\n    $('#more-condition').click(getCondition);\r\n    $('#condition').click(hideCondition);\r\n    $('.c-dreamers').slick(dreamersConfig);\r\n    $('#condition').hide();\r\n\r\n\r\n    function getCondition() {\r\n        $('.c-section_condition .c-section__content').css(\"height\", \"auto\");\r\n        $('#more-condition').hide();\r\n        $('#condition').show();\r\n\r\n        $.fn.fullpage.reBuild();\r\n\r\n    }\r\n\r\n\r\n    function hideCondition() {\r\n        $('.c-section_condition .c-section__content').css(\"height\", \"90vh\");\r\n        $('#more-condition').show();\r\n        $('#condition').hide();\r\n\r\n        $.fn.fullpage.reBuild();\r\n\r\n    }\r\n\r\n    /*$('.c-modal__block').click((event) => {\r\n        event.stopPropagation();\r\n    })*/\r\n    $('.c-modal').on('click', e => {\r\n\r\n        if ($(window).width() > 767 && !window.ontouchstart) {\r\n            if($(e.target).closest('.c-modal__block').length > 0 ) return;\r\n            $('body').removeClass('active');\r\n            $.fn.fullpage.setAllowScrolling(true);\r\n        }\r\n    })\r\n\r\n\r\n    $('.c-modal__close').click(() => {\r\n        $('body').removeClass('active');\r\n    })\r\n\r\n    function getCards() {\r\n        $.ajax({\r\n            url: '//admin.msmechta.ru/results/msgirlstest?count=' + cardsrequestCount + '&page=' + (cardsPagesCount - 1),\r\n            type: 'GET'\r\n        }).done((cards) => {\r\n            cardsPagesCount++;\r\n            cards = assignId(cards.posts, cardsArray.length);\r\n            cardsArray = cardsArray.concat(cards);\r\n            if (cards.length > 0) {\r\n                cardsLoader = $('.c-cards-holder').masonry(masonryConfig);\r\n                isMasonryCreated = true;\r\n\r\n                let counter = 0, appendTimeout;\r\n\r\n\r\n\r\n                let newCards = cards.map((card) => {\r\n                    let newCard = createCard(card);\r\n                   \r\n                    return newCard;\r\n                });\r\n\r\n\r\n               /* appendTimeout = setTimeout(() => {\r\n                    if(counter === cards.length) {\r\n\r\n                    }\r\n                }, 100)\r\n*/\r\n\r\n                cardsLoader.append(newCards).masonry('appended', newCards).masonry('reloadItems');\r\n                \r\n                $.fn.fullpage.reBuild();\r\n                if (cards.length < cardsrequestCount) {\r\n                    $('#more-cards').hide();\r\n                    $.fn.fullpage.setAllowScrolling(true);\r\n                }\r\n            } else {\r\n                if (isMasonryCreated) {\r\n                    cardsLoader.masonry('destroy');\r\n                    isMasonryCreated = false;\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    $(document).on('click', '.c-card', clickHandler);\r\n\r\n\r\n    function clickHandler() {\r\n        console.log('click card event');\r\n        let id = $(this).attr('id');\r\n        for (var index = 0; index < cardsArray.length; index++) {\r\n            if (cardsArray[index].id == id) {\r\n                let currentCard = cardsArray[index];\r\n                let fullBlock = $('.c-modal__content');\r\n                fullBlock.find('.c-modal__name').html(currentCard.name);\r\n                fullBlock.find('.c-modal__image').attr('src', currentCard.image);\r\n                fullBlock.find('.c-modal__full-description').html(currentCard.text);\r\n                $.fn.fullpage.setAllowScrolling(false);\r\n                $('body').addClass('active');\r\n            }\r\n        }\r\n    }\r\n\r\n    function reduceText(string) {\r\n        if (string.length > visibleSymbols) {\r\n            string = string.substring(0, visibleSymbols) + ' ...';\r\n        }\r\n        return string;\r\n    }\r\n\r\n    function assignId(cards, lastIndex) {\r\n        return cards.map((card, index) => {\r\n            card.id = 'card-' + (lastIndex + index + 1);\r\n            return card;\r\n        })\r\n    }\r\n\r\n    function createCard(card) {\r\n        let heightCoefficient = card.imgHeight / card.imgWidth;\r\n\r\n        let img = new Image();\r\n        img.src = card.image;\r\n        let width = img.naturalWidth ? img.naturalWidth : 100;\r\n        let height = img.naturalHeight ? img.naturalHeight : 100;\r\n        let dim = width/height;\r\n\r\n        if (dim < .9) {\r\n            card.modifer = 'vertical'\r\n        } else if(dim >= 1.15) {\r\n            card.modifer = 'horizontal'\r\n        }  else {\r\n            card.modifer = 'square'\r\n        }\r\n        \r\n       \r\n\r\n        return $(\r\n            `<div class='c-card ${card.providerType}' id='${card.id}' data-modifer='${card.modifer}'>` +\r\n            `<div class='c-card__image c-card__image--${card.modifer}'` +\r\n            `style='background-image: url(${card.image});'>` +\r\n            `<div class='c-social__post c-social--${card.providerType}'></div>` +\r\n            `<div class='c-card__image_embedded'></div></div>` +\r\n            `<div class='c-card__about'>` +\r\n            `<div class='c-card__name'>${card.name}</span></div>` +\r\n            `<div class=\"c-card__description\">${reduceText(card.text)}</div></div></div>`\r\n        ).get(0);\r\n    };\r\n\r\n    $(window).on('resize', resizeHandler);\r\n\r\n    function resizeHandler() {\r\n        if ($(window).width() > 767) {\r\n\r\n        } else {\r\n            if (isMasonryCreated) {\r\n                cardsLoader.masonry('reloadItems');\r\n            }\r\n        }\r\n    }\r\n});"]}