{"version":3,"sources":["common.js"],"names":["$","createImgNode","element","src","img","document","createElement","onload","attr","addClass","getCards","ajax","url","cardsrequestCount","cardsPagesCount","type","done","cards","assignId","posts","cardsArray","length","concat","cardsLoader","masonry","masonryConfig","isMasonryCreated","newCards","map","card","newCard","createCard","append","forEach","click","clickHandler","fn","fullpage","reBuild","hide","id","this","index","currentCard","fullBlock","find","html","name","image","text","reduceText","string","visibleSymbols","substring","lastIndex","heightCoefficient","imgHeight","imgWidth","providerType","get","resizeHandler","window","width","itemSelector","columnWidth","percentPosition","bloggerConfig","dots","arrows","infinite","vertical","speed","slidesToShow","slidesToScroll","prevArrow","nextArrow","dotsClass","responsive","breakpoint","settings","dreamersConfig","centerMode","draggable","focusOnSelect","variableWidth","isOpen","each","on","toggleClass","fadeToggle","trigger","scrollOverflow","navigation","slick","event","stopPropagation","removeClass"],"mappings":"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","file":"../sources/common.js","sourcesContent":["$(function () {\n    let isMasonryCreated = false;\n    let cardsLoader;\n    let cardsArray = [];\n    let masonryConfig = {\n        itemSelector: '.c-card',\n        columnWidth: '.c-card__sizer',\n        percentPosition: true\n    };\n    let bloggerConfig = {\n        dots: true,\n        arrows: true,\n        infinite: false,\n        vertical: false,\n        speed: 800,\n        slidesToShow: 4,\n        slidesToScroll: 4,\n        prevArrow: '<svg class=\"c-arrow c-arrow__prev\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#arrow-l\"></use></svg>',\n        nextArrow: '<svg class=\"c-arrow c-arrow__next\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#arrow-r\"></use></svg>',\n        dotsClass: 'slick-dots c-bloggers__dots',\n        responsive: [\n            {\n                breakpoint: 992,\n                settings: {\n                    slidesToShow: 3,\n                    slidesToScroll: 3\n                }\n            },\n            {\n                breakpoint: 767,\n                settings: {\n                    slidesToShow: 2,\n                    slidesToScroll: 2\n                }\n            }, {\n                breakpoint: 480,\n                settings: {\n                    slidesToShow: 1,\n                    slidesToScroll: 1\n                }\n            }\n        ]\n    };\n    let dreamersConfig = {\n        dots: false,\n        centerMode: true,\n        arrows: true,\n        infinite: true,\n        draggable: true,\n        speed: 500,\n        slidesToShow: 5,\n        focusOnSelect: true,\n        variableWidth: true,\n        prevArrow: '<svg class=\"c-arrow c-arrow__prev\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#arrow-l\"></use></svg>',\n        nextArrow: '<svg class=\"c-arrow c-arrow__next\"><use xmlns:xlink=\"http://www.w3.org/1999/xlink\" xlink:href=\"#arrow-r\"></use></svg>',\n        responsive: [\n            {\n                breakpoint: 992,\n                settings: {\n                    slidesToShow: 3\n                }\n            },\n            {\n                breakpoint: 767,\n                settings: {\n                    slidesToShow: 2\n                }\n            }, {\n                breakpoint: 480,\n                settings: {\n                    slidesToShow: 1\n                }\n            }\n        ]\n    }\n    let cardsPagesCount = 1;\n    const visibleSymbols = 85;\n    const cardsrequestCount = 8;\n    let isOpen = false;\n\n    $('.lazy').each(function() {\n        let src = $(this).attr('data-lazy');\n        createImgNode($(this), src);\n    })\n\n    function createImgNode (element, src) {\n        var img = document.createElement(\"img\");\n        img.src = src;\n        img.onload = function () {\n            element.attr('style', 'background-image: url(' + src +');');\n            element.addClass('visible');\n            $('.c-section__header').attr('style', 'bottom: 120px');\n        }\n\n    }\n\n    $('.js-menu-button').on('click', function() {\n        $('html').toggleClass('t-open-menu');\n        $('.c-menu-fixed').fadeToggle(200, function() {\n        isOpen = !isOpen;\n        $('.c-menu-fixed').trigger('toggle', isOpen);\n        });\n    });\n\n    $('.c-section-container').fullpage({\n        scrollOverflow: true,\n        navigation: true\n    });\n\n    getCards();\n    $('.c-bloggers').slick(bloggerConfig);\n    $('#more-cards').click(getCards);\n    $('.c-dreamers').slick(dreamersConfig);\n\n    $('.c-modal__block').click((event) => {\n        event.stopPropagation();\n    })\n    $('.c-modal').click(() => {\n        if ($(window).width() > 767) {\n            $('.c-modal').removeClass('active');\n        }\n    })\n    $('.c-modal__close').click(() => {\n        $('.c-modal').removeClass('active');\n    })\n\n    function getCards() {\n        $.ajax({\n            url: '//admin.msmechta.ru/results/msgirlstest?count=' + cardsrequestCount + '&page=' + (cardsPagesCount - 1),\n            type: 'GET'\n        }).done((cards) => {\n            cardsPagesCount++;\n            cards = assignId(cards.posts, cardsArray.length);\n            cardsArray = cardsArray.concat(cards);\n            if (cards.length > 0) {\n                cardsLoader = $('.c-cards-holder').masonry(masonryConfig);\n                isMasonryCreated = true;\n                let newCards = cards.map((card) => {\n                    let newCard = createCard(card);\n                    return newCard;\n                });\n                cardsLoader.append(newCards).masonry('appended', newCards).masonry('reloadItems');\n                newCards.forEach((card) => {\n                    $(card).click(clickHandler);\n                })\n                $.fn.fullpage.reBuild();\n                if (cards.length < cardsrequestCount) {\n                    $('#more-cards').hide();     \n                }\n            } else {\n                if (isMasonryCreated) {\n                    cardsLoader.masonry('destroy');\n                    isMasonryCreated = false;\n                }\n            }\n        })\n    }\n\n    function clickHandler() {\n        let id = $(this).attr('id');\n        for (var index = 0; index < cardsArray.length; index++) {\n            if (cardsArray[index].id == id) {\n                let currentCard = cardsArray[index];\n                let fullBlock = $('.c-modal__content');\n                fullBlock.find('.c-modal__name').html(currentCard.name);\n                fullBlock.find('.c-modal__image').attr('src', currentCard.image);\n                fullBlock.find('.c-modal__full-description').html(currentCard.text);\n                $('.c-modal').addClass('active');\n            }\n        }\n    }\n\n    function reduceText(string) {\n        if (string.length > visibleSymbols) {\n            string = string.substring(0, visibleSymbols) + ' ...';\n        }\n        return string;\n    }\n\n    function assignId(cards, lastIndex) {\n        return cards.map((card, index) => {\n            card.id = 'card-' + (lastIndex + index + 1);\n            return card;\n        })\n    }\n\n    function createCard(card) {\n        let heightCoefficient = card.imgHeight / card.imgWidth;\n        return $(\n            `<div class='c-card ${card.providerType}' id='${card.id}'>` +\n            `<div class='c-card__image'` +\n            `style='background-image: url(${card.image});'>` +\n            `<div class='c-card__image_embedded'` +\n            `style='padding-top: ${heightCoefficient ? 100 * heightCoefficient + '%' : '100%'};'></div></div>` +\n            `<div class='c-card__about'>` +\n            `<div class='c-card__name'>${card.name}</span></div>` +\n            `<div class=\"c-card__description\">${reduceText(card.text)}</div></div></div>`\n        ).get(0);\n    };\n\n    $(window).on('resize', resizeHandler);\n\n    function resizeHandler() {\n        if ($(window).width() > 767) {\n\n        } else {\n            if (isMasonryCreated) {\n                cardsLoader.masonry('reloadItems');\n            }\n        }\n    }\n});\n"]}